---
version: 2

registries:
  pytorch-cpu:
    type: python-index
    url: https://download.pytorch.org/whl/cpu
    replaces-base: false

updates:
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "daily"
    insecure-external-code-execution: allow
    registries:
      - pytorch-cpu
    ignore:
      # The openai SDK currently triggers the GitHub-managed
      # dependabot/dependabot-updates workflow to fail when it tries to
      # resolve upgrades (see workflow run 20163970215).  Skip automated
      # bumps so scheduled runs complete successfully; we will refresh this
      # dependency manually when needed.
      - dependency-name: "openai"
      # Heavy ML packages routinely fail to resolve in Dependabot's
      # constrained execution environment.  Skip them so the scheduled
      # job stops erroring while manual updates continue to happen via
      # regular PRs.
      - dependency-name: "numba"
      - dependency-name: "shap"
      - dependency-name: "mlflow"
      - dependency-name: "mlflow-skinny"
      - dependency-name: "mlflow-tracing"
      - dependency-name: "torch"
      - dependency-name: "torchvision"
      - dependency-name: "torchaudio"
      - dependency-name: "vllm"
      - dependency-name: "pytorch-lightning"
      - dependency-name: "torchmetrics"
      - dependency-name: "huggingface-hub"
      - dependency-name: "transformers"
      # GPU-tuned runtimes and their support stack take several minutes to
      # resolve and routinely trigger the 20 minute timeout in the
      # dependabot/dependabot-updates workflow.  Exclude them from automated
      # refreshes so the job completes successfully and we can batch these
      # upgrades manually when GPU images are rebuilt.
      - dependency-name: "cupy-cuda12x"
      - dependency-name: "tensorflow"
      - dependency-name: "keras"
      - dependency-name: "tensorboard"
      - dependency-name: "tensorboard-data-server"
      - dependency-name: "ml-dtypes"
      - dependency-name: "opt-einsum"
      - dependency-name: "optree"
      - dependency-name: "sympy"
      # Reinforcement learning stacks also exceed Dependabot's solver
      # thresholds; keep them frozen until we refresh the training images
      # out-of-band.
      - dependency-name: "stable-baselines3"
      - dependency-name: "gymnasium"
      - dependency-name: "lightning-utilities"
      - dependency-name: "ray"
      # Heavily compiled data-processing runtimes frequently time out in the
      # GitHub-hosted Dependabot environment.  Skipping them keeps the
      # managed dependabot/dependabot-updates workflow green while we update
      # them manually alongside our image builds.
      - dependency-name: "pyarrow"
      - dependency-name: "polars"
      - dependency-name: "grpcio"
      # NumPy 2.4+ currently conflicts with the pinned numba runtime.
      - dependency-name: "numpy"
        versions:
          - ">=2.4"
      # ccxtpro is a commercial package that often trips Dependabot's rate
      # limits; it is safer to upgrade it manually together with the
      # matching back-end services.
      - dependency-name: "ccxtpro"
      # Heavy model stacks regularly exhaust Dependabot's solver budget or
      # require system dependencies that are unavailable in the managed
      # runner.  Skip them in automated checks to keep the scheduled job
      # green; we will refresh them manually alongside the GPU images.
      - dependency-name: "langchain"
      - dependency-name: "llama-index"
      - dependency-name: "chromadb"
      - dependency-name: "sentence-transformers"
      - dependency-name: "onnxruntime"
      - dependency-name: "onnxruntime-gpu"
      - dependency-name: "faiss-cpu"
      - dependency-name: "faiss-gpu"
      - dependency-name: "xgboost"
      - dependency-name: "lightgbm"
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "weekly"
